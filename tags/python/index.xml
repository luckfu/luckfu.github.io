<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>python on luckfu的潦草笔记</title><link>http://www.luckfu.com/tags/python/</link><description>Recent content in python on luckfu的潦草笔记</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><lastBuildDate>Sat, 17 Sep 2022 00:00:00 +0000</lastBuildDate><atom:link href="http://www.luckfu.com/tags/python/index.xml" rel="self" type="application/rss+xml"/><item><title>Ftp读取文件到BytesIO缓存读文件</title><link>http://www.luckfu.com/post/2022-09-17_python_ftp_bytesio/</link><pubDate>Sat, 17 Sep 2022 00:00:00 +0000</pubDate><guid>http://www.luckfu.com/post/2022-09-17_python_ftp_bytesio/</guid><description>从ftp服务器读文件到内存不在客户端生成本地文件 def openFtpFileBytesIO(fileName,ftpServer,ftpUser=&amp;#39;anonymous&amp;#39;,ftpPass=&amp;#39;&amp;#39;,port=21): &amp;#34;&amp;#34;&amp;#34; 读ftp文件到缓存 &amp;#34;&amp;#34;&amp;#34; ftps = FTP() ftps.connect(ftpServer,port) ftps.login(ftpUser,ftpPass) download_file = BytesIO() ftps.retrbinary(&amp;#39;RETR &amp;#39; + str(fileName), download_file.write) download_file.seek(0) return download_file def readFile(f): while True: line = f.readline() if line: print(line) else: f.close() break if __name__==&amp;#34;__main__&amp;#34;: f=openFtpFileBytesIO(&amp;#39;test.csv&amp;#39;,&amp;#39;192.168.0.3&amp;#39;) readFile(f)</description></item><item><title>python 快速判断字符串是否包含中文</title><link>http://www.luckfu.com/post/2022-06-21_str_contain_chinese/</link><pubDate>Tue, 21 Jun 2022 00:00:00 +0000</pubDate><guid>http://www.luckfu.com/post/2022-06-21_str_contain_chinese/</guid><description>&lt;p>事情是这样的，最近优化一个数据导出程序，数据库是UTF-8，要求导出文件编码为GBK,在python中,传统的写法:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>xxx&lt;span style="color:#666">.&lt;/span>decode(&lt;span style="color:#b44">&amp;#39;utf-8&amp;#39;&lt;/span>)&lt;span style="color:#666">.&lt;/span>encode(&lt;span style="color:#b44">&amp;#39;gbk&amp;#39;&lt;/span>,&lt;span style="color:#b44">&amp;#39;ignore&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>但decode和encode在一个几千万行的文件导出时，耗时太长，粗略测试不做decode的导出，至少性能提高三倍，可这时会有新的问题出现，假如数据中有中文或别的编码文字，编码会出错。&lt;/p></description></item><item><title>python使用yahoo_financials_stmt包获取雅虎财经的股票财务数据</title><link>http://www.luckfu.com/post/2022-05-21_yahoo_financials_stmt/</link><pubDate>Sat, 21 May 2022 00:00:00 +0000</pubDate><guid>http://www.luckfu.com/post/2022-05-21_yahoo_financials_stmt/</guid><description>&lt;p>    外围市场免费的股票财务数据接口难找，从雅虎财经提取财务数据可能是免费方案中最简单的方法，自从yahoo财经取消API支持后，只能自己爬取或使用第三方库，但是yahoo偶尔的页面变更和地区限制也给爬取数据造成很大困扰。&lt;/p>
&lt;p>    本文介绍我最近提交的yahoo_financials_stmt包获取股票财务数据 项目地址：https://github.com/luckfu/yahoo_financials_stmt&lt;/p>
&lt;blockquote>
&lt;p>因为yahoo限制中国大陆地区使用，所以如果你在大陆地区，需要自行代理&lt;/p>
&lt;/blockquote>
&lt;h1 id="使用说明">使用说明：&lt;/h1></description></item><item><title>终于开通 github Codespace</title><link>http://www.luckfu.com/post/2022-05-18_codespace/</link><pubDate>Wed, 18 May 2022 00:00:00 +0000</pubDate><guid>http://www.luckfu.com/post/2022-05-18_codespace/</guid><description>&lt;p>&lt;img src="http://www.luckfu.com/post/images/2022-05-18/WechatIMG11601.jpeg" alt="">&lt;/p>
&lt;p>等待了两年，github终于接受了我的测试申请,开通Codespace beta,老实说差不多都忘了这事儿，毕竟在github上VS Code编辑加action我都已经很满足了， 所以刚看到开通，还以为自己眼花，怎么在收费的项目还给免费beta测试。&lt;/p></description></item><item><title>利用shapely库计算多边形包含和相交关系</title><link>http://www.luckfu.com/post/2022-04-26_shapely/</link><pubDate>Tue, 26 Apr 2022 00:00:00 +0000</pubDate><guid>http://www.luckfu.com/post/2022-04-26_shapely/</guid><description>&lt;p>最近接到一个需求，计算一个坐标点(经纬度)是否在多边形(地理区域)内，之前写代码的哥们非常用功的搞懂了计算原理并用SQL实现了完整代码🐮，but计算完所有数据需要一周时间，这个项目的负责人打电话问我，有没有更快的办法，我想了想，假如这个办法真的这么复杂，极端情况下只能看懂计算方法换别的方式实现，不过Life is short, you need Python ，于是很轻松的搜索到了shapely库。
&lt;img src="http://www.luckfu.com/post/images/2022-04-26/2022-04-26-01.jpeg" alt="">&lt;/p>
&lt;blockquote>
&lt;p>shapely是专门做图形计算的包，基本上图形线段，点的判断包里都有，shapely里主要由Point，LineString，Polygon这三类组成，在shapely里点，线，面之间都是可以做判断的，比如说计算点到线段的距离，点到面之间的距离，点与点之间的距离，点是否在一个图形的内部或外部，或边界上，线是否在图形的内部等。&lt;/p>
&lt;/blockquote></description></item></channel></rss>