<?xml version="1.0" encoding="utf-8" standalone="yes"?><search><entry><title>HoRNDIS驱动提供Android USB共享网络给macOS Monterey</title><url>http://www.luckfu.com/post/horndis_mac/</url><categories><category>Monterey</category><category>macOS</category><category>RNDIS</category><category>USB网络共享</category><category>HoRNDIS</category></categories><tags><tag>Monterey</tag><tag>macOS</tag><tag>RNDIS</tag><tag>HoRNDIS</tag></tags><content type="html"> 1、macOS的RNDIS支持 apple的小动作从Monterey开始取消蓝牙PAN网络共享之后，不得不想其它连接方法实现双网络，Android的USB网络共享基于RNDIS协议，据说在windows下可用，但macOS没有原生支持，在mac下的第三方实现目前似乎只有HoRNDIS 官网 https://www.joshuawise.com/horndis 但官网经年未更新过了，提供的最新版仅仅支持到 macOS10.10 Yosemite，直接下载安装会提示系统阻止不安全插件，好在HoRNDIS开源社区还比挺活跃 可以通过github上相关分支安装对应版本。
2、HoRNDIS 下载 Monterey 对应的 https://github.com/chris1111/HoRNDIS 下载地址 https://github.com/chris1111/HoRNDIS/releases
下载文件后解压可见 3、安装 安装步骤说明在 “GUIDE Consent HoRNDIS.pdf”中
3.1 允许安装 因为是第三方打包的程序，所以需要添加手工添加公证 执行 Consent-HoRNDIS.command，如果系统阻止，在“系统偏好设置”=>&ldquo;隐私与安全"中允许，
3.2 关闭SIP 进入Recovery模式，关闭SIP
重启，开机按住command+R键，进入恢复模式 点击实用工具 => 点击终端 终端内输入命令：csrutil disable 终端内输入命令：/usr/sbin/spctl kext-consent add 54GTJ2AU36 重启 3.3 安装HoRNDIS 打开 HoRNDIS-Consent.pkg 3.4 允许HoRNDIS 内核扩展 在“系统偏好设置”=>&ldquo;隐私与安全"中允许app从任意位置 最后通过 USB 将手机连接到 Mac，打开手机上的usb网络共享&hellip;.</content></entry><entry><title>Kubernetes修改NodePort范围必须要注意的问题</title><url>http://www.luckfu.com/post/k8s-nodeport-range/</url><categories><category>k8s</category></categories><tags><tag>k8s</tag></tags><content type="html"> Kubernetes 集群中NodePort默认范围是 30000-32767，网络上对修改方法的说明很多，但最近的实际操作中，有一个隐藏的问题，让我花了一天时间。
在Master节点上的文件 /etc/kubernetes/manifests/kube-apiserver.yaml，修改此文件，向其中添--service-node-port-range=1-65535
#作为一个常年操作在线系统的的人，一定会先备份配置文件，没有异议吧？ cp kube-apiserver.yaml kube-apiserver.yaml.bak vi kube-apiserver.yaml ..... Host Port: &lt;none> Command: kube-apiserver - --service-cluster-ip-range=10.96.0.0/12 # 插入 - --service-node-port-range=1-65535 ...... 之后，大部分文档告诉你需要
# 获得 apiserver 的 pod 名字 export apiserver_pods=$(kubectl get pods --selector=component=kube-apiserver -n kube-system --output=jsonpath={.items..metadata.name}) # 删除 apiserver 的 pod kubectl delete pod $apiserver_pods -n kube-system 又或者说还要重启服务
systemctl daemon-reload systemctl restart kubelet 甚至还有如果你有多master节点，需要每个master节点操作一次的说法,但实际情况是，不需要每台master重复操作(k8s会自己同步)，你既不需要重启master节点，也不需要删除pod的方式重启kube-apiserver
你真正需要的只是修改kube-apiserver.yaml，修改完成后你会发现无论你删除pod重启还是重启服务，新配置都不生效，其实问题就出在备份文件，移走kube-apiserver.yaml.bak 再查看
kubectl describe pod $apiserver_pods -n kube-system 你会发现端口范围已经修改生效！</content></entry><entry><title>macOS Monterey中蓝牙PAN(Bluetooth PAN)到哪里去了？ 😡</title><url>http://www.luckfu.com/post/macos_monterey_bluetooth_apn/</url><categories><category>Monterey</category><category>Bluetooth PAN</category><category>macOS</category></categories><tags><tag>Monterey</tag><tag>Bluetooth PAN</tag><tag>macOS</tag></tags><content type="html"> 我有一台办公的旧mac，操作系统是big sur，使用wifi连接内网，同时蓝牙连接手机上外网，这对我来说是办公的硬性需求，然而不幸的是最近升级了Monterey，蓝牙网络连接没有了。
macOS big sur时的蓝牙连接网络 macOS Monterey时，连接网络消失了 更不幸的是，为了测试是不是升级到macOS Monterey引起的这个问题，我把另一台mac air也升级到了Monterey，于是我手里所有的电脑都不能连接蓝牙网络了。</content></entry><entry><title>联邦学习框架 FATE 单机版源码部署 ARM主机</title><url>http://www.luckfu.com/post/fate_install/</url><categories><category>FATE</category><category>联邦学习</category></categories><tags><tag>FATE</tag><tag>FATE-Board</tag><tag>联邦学习</tag></tags><content type="html"> FATE(Federated AI Technology Enabler)是一个联邦学习框架。本文大部分内容来自官方文档整合，单独记录的原因是这次需要源码部署，官方部署文档 https://github.com/FederatedAI/FATE 中一些细节需要自己摸索，形成总结。
1.部署前环境检查 python环境 jdk Maven 本地8080、9360、9380端口是否被占用 netstat -apln|grep 8080 netstat -apln|grep 9360 netstat -apln|grep 9380 2. 设置环境变量 设置环境变量是因为FATA框架中，很多脚本要用到环境变量
export branch={分支名称, 若使用某个发布版本分支, 则为`v版本号`, 如`v1.7.0`} export version={FATE版本号, 如1.7.0} export version_tag={FATE版本标签, 如rc1/rc2/release} 3. 获取源码 git clone https://github.com/FederatedAI/FATE.git -b ${branch} --recurse-submodules --depth=1 #或者 git clone https://gitee.com/FederatedAI/FATE.git -b ${branch} --depth=1; #更新代码 cd FATE; bash build/common/update_submodule_from_gitee.sh git pull git submodule update --remote 4. 运行时环境变量 cd {上述代码的存放目录} export FATE_PROJECT_BASE=$PWD export version=`grep "FATE=" ${FATE_PROJECT_BASE}/fate.env | awk -F "=" '{print $2}'` 5. 安装FATE所需要的Python依赖包 5.1 修改依赖包说明文件 官方部署文档中 requirements版本要求非常严格，实际部署中，可能因为某些原因无法满足，比如我的环境是ARM版Ubuntu,tensorflow和pytouch的版本支持有限，这种情况下可以删除python/requirements.txt的版本描述。原则上版本高一点是可以的。
在 python/requirements.txt 增加
ruamel.yaml peewee apsw dotenv redis cos-python-sdk-v5 beautifultable kazoo coverage cloudpickle lmdb coverage pycryptodomex libsm3py 5.2 安装Python依赖包 cd ${FATE_PROJECT_BASE}; sh bin/install_os_dependencies.sh; source ${FATE_VENV_BASE}/bin/activate; pip install -r python/requirements.txt 6. 配置FATE 编辑bin/init_env.sh环境变量文件
cd ${FATE_PROJECT_BASE} sed -i.bak "s#PYTHONPATH=.*#PYTHONPATH=$PWD/python:$PWD/fateflow/python#g" bin/init_env.sh; sed -i.bak "s#venv=.*#venv=${FATE_VENV_BASE}#g" bin/init_env.sh 检查conf/service_conf.yaml全局配置文件中是否将基础引擎配置为单机版, 若default_engines显示如下，则为单机版
default_engines:computing:standalonefederation:standalonestorage:standalone7. 启动fate flow server cd ${FATE_PROJECT_BASE}; source bin/init_env.sh; cd fateflow; bash bin/service.sh status; bash bin/service.sh start 显示如下类似则为启动成功，否则请依据提示查看日志
bash service start sucessfully. pid: 111907 status:app 111907 75.7 1.1 3740008 373448 pts/2 Sl+ 12:21 0:17 python /xx/FATE/fateflow/python/fate_flow/fate_flow_server.py python 111907 app 14u IPv4 3570158828 0t0 TCP localhost:boxp (LISTEN) python 111907 app 13u IPv4 3570158827 0t0 TCP localhost:9360 (LISTEN) 8. 安装fate client cd ${FATE_PROJECT_BASE}; source bin/init_env.sh; cd python/fate_client/; python setup.py install 初始化fate flow client
cd ../../; flow init -c conf/service_conf.yaml 显示如下类似则为初始化成功，否则请依据提示查看日志
{ "retcode": 0, "retmsg": "Fate Flow CLI has been initialized successfully." } 9. FATE-Board 安装 FATE-Board的部署需要java环境和Maven
9.1 配置修改 修改 ${FATE_PROJECT_BASE}/fateboard/src/main/resources/application.properties 文件
spring.datasource.driver-Class-Name=org.sqlite.JDBC ··· fateboard.datasource.jdbc-url=jdbc:sqlite:路径/数据库文件名 9.2 打包 cd fateboard/ mvn clean package -DskipTests 9.3 启动 FATE-Board nohup \ java -Dspring.config.location=${FATE_PROJECT_BASE}/fateboard/src/main/resources/application.properties \ -Dssh_config_file=${FATE_PROJECT_BASE}/fateboard//src/main/resources/ \ -Xmx2048m -Xms2048m -XX:+PrintGCDetails \ -Xloggc:gc.log -XX:+HeapDumpOnOutOfMemoryError \ -jar ${FATE_PROJECT_BASE}/fateboard//target/fateboard-${version}.jar > /dev/null 2>&amp;1 &amp; 访问 http:127.0.0.1:8080 用户名 admin 密码 admin
10. 测试项 10.1 Toy测试 flow test toy -gid 10000 -hid 10000 如果成功，屏幕显示类似下方的语句:
success to calculate secure_sum, it is 2000.0 10.2 单元测试 cd ${FATE_PROJECT_BASE}; bash ./python/federatedml/test/run_test.sh 如果成功，屏幕显示类似下方的语句:
there are 0 failed test</content></entry><entry><title>hugo + github action + github vscode 真香</title><url>http://www.luckfu.com/post/first_github_action/</url><categories><category>github</category><category>github action</category><category>hugo</category></categories><tags><tag>github</tag><tag>github action</tag><tag>hugo</tag></tags><content type="html"> github action 真香，github的vscode编辑器真香，结合起来😄 本站是基于hugo发布在github pages上,这种静态网站比较麻烦的是，本地编辑本地发布，public发布到github.io,如果还要源码也存入github，还得再建一个repo存源码，public作为submodule添加到根repo，deploy时还得submodule update， 还好此时有action，通过:actions-hugo，只需要发布源码的repo，就可以更新github pages,真香
更香的是，github 推出了牛逼哄哄的vscode编辑器，只要在源码项目上点.键 自动进入网页版vscode，自带git，现在可以通过这个编辑器在线编写内容，保存提交，action自动发布，实现在线编辑blog的需求。</content></entry><entry><title>将docker容器作为虚拟机折腾</title><url>http://www.luckfu.com/post/ampere_a1_docker/</url><categories><category>cloud vps</category><category>docker</category></categories><tags><tag>Oracle Cloud</tag><tag>Free VPS</tag><tag>docker</tag><tag>VM.Standard.A1.Flex</tag></tags><content type="html"> 上一篇说到Oracle Cloud免费且大热的4c24g的VM.Standard.A1.Flex机型难申请，而实际使用中，oracle cloud免费套餐中陷阱还是很多的，以下是几种常见情况：
免费主机超额度，免费存储超额度，oc优先停掉的资源就是这个A1.Flex机型。
A1.Flex机型可选操作系统只有oracle linux 7或8，不一定顺手。
操作系统被玩坏时，不像一般云服务控制台可以恢复镜像，你只能重新申请
将容器作为虚拟机使用并不符合容器应用部署的初衷，但鉴于以上问题本文中采用docker创建一个容器代替虚拟机，一切在虚机中操作，当系统灾难不可恢复时，删掉就好，省却刷机抢注之苦。
布署步骤 ssh 登录到主机
1、安装docker yum install docker 2、Dockerfile 编写Dockerfile
FROMubuntu:20.04LABELMAINTAINER="luckfu.com"USERroot# change root password to `ubuntu` RUNecho'root:ubuntu'|chpasswdENVDEBIAN_FRONTENDnoninteractive# install ssh server RUNapt-getupdate&amp;&amp;apt-getinstall-y\openssh-serversudo\&amp;&amp;rm-rf/var/lib/apt/lists/* \ &amp;&amp; mkdir -p /run/sshd \ &amp;&amp; ssh-keygen -A \ &amp;&amp; sed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin yes/g' /etc/ssh/sshd_config \ &amp;&amp; apt-get purge -y --auto-remove EXPOSE 22 # run ssh server CMD ["/usr/sbin/sshd", "-D", "-o", "ListenAddress=0.0.0.0"] 3、生成镜像 docker build -f ./Dockerfile -t ubuntu-ssh 使用 docker images命令查看
docker images REPOSITORY TAG IMAGE ID CREATED SIZE ubuntuos-ssh latest b6010c26ebb7 1 days ago 189MB ubuntu 20.04 d5ca7a445605 8 weeks ago 65.6MB 4、启动容器 执行命令
docker run -d -p 9022:22 -p 8000-9000:8000-9000 \ -v /data/:/data \ --name ubuntuos-ssh ubuntuos-ssh 主要参数及含义：
参数 解释 -d 守护进程模式 -p 端口映射 [主机端口:容器端口] -v 存储卷映射 [主机目录:容器目录] &ndash;name 指定容器名称 ubuntuos 上述命令中我们部署了一个名称为ubuntuos-ssh的容器，将主机的/data(oracle cloud 中可以申请100G“始终免费”存储，挂载到主机/data)挂载到容器的/data下，将主机的9022映射容器的ssh服务22端口，另外开放了8000-9000端口备用
查看容器是否运行
CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 0c9cf191daf2 ubuntuos-ssh "/usr/sbin/sshd -D -…" 12 days ago Up 12 days 0.0.0.0:8000-9000->8000-9000/tcp, :::8000-9000->8000-9000/tcp, 0.0.0.0:9022->22/tcp, :::9022->22/tcp ubuntuos-ssh 登录容器ß
这里我们要使用ssh，而不是exec -it 进入
密码 ubuntu
ssh root@localhost -p 9022 root@localhost's password: (base) root@xxxxxxx:~# 到这里如果正常登录，则说明容器正常运行
5、通过网络登录 登录oracle cloud控制台
检查容器使用的 22 8000-9000端口是否开通 主机检查防火墙如iptables firwwall中，端口是否打开 远程登录 ssh root@IP -p 9022 可劲造吧</content></entry><entry><title>使用python脚本抢注Oracle甲骨文 VM.Standard.A1.Flex</title><url>http://www.luckfu.com/post/ampere_a1_free/</url><categories><category>cloud vps</category><category>python</category><category>oci</category></categories><tags><tag>Oracle Cloud</tag><tag>Free VPS</tag><tag>python script</tag><tag>自动化脚本</tag><tag>VM.Standard.A1.Flex</tag></tags><content type="html"> Oracle cloud 开放注册账号能申请4c24g的免费云服务器,数据库以及其他的服务，1c1g的x86服务器比较容易申请，但热门的4c24g的Ampere A1类型主机通过网页正常申请根本申请不到，目前网络上流行的抢注方法无外乎两种模式：
浏览器插件或脚本或按键精灵，这种方法的问题是控制台超时，还容易被服务器判定非法操作，禁用账号，对于动辄要求稳定运行几天才能完成的操作，显然已经不合适。 调用oci命令脚本，这是最安全的模式，因为oci是oracle官方提供，原理是使用oci命令直接申请实例，例如： oci compute instance launch .... 然而，根据我香港主机测试，这种最多只能做到20秒刷新一次，原因是 oci 命令执行的完整的过程：
1、启动、开始连接 oracle cloud 2、验证用户合法性 3、执行命令 4、退出 1，2，4步骤在循环中浪费了大量时间，本文中采用python调用oci api 的模式，一次登录省略多次验证环节，循环执行创建instance命令，刷新速度可以达到3秒/次 当返回instance创建成功时，自动退出。
布署步骤 1、下载oci工具 bash -c "$(curl –L https://raw.githubusercontent.com/oracle/oci-cli/master/scripts/install/install.sh)" 默认回车，安装完成后，执行下面命令检查是否成功
oci -v 2、配置oci连接 在oracle cloud控制台上，点击右上角头像=>菜单中选择“用户设置” 复制用户和租户ID 输入
oci setup config 填写正确的用户和租户id
Enter a location for your config [/root/.oci/config]: Enter a user OCID: #输入你的用户ocid Enter a tenancy OCID: #输入你租户的用户id Enter a region by index or name(e.g. 1: ap-chiyoda-1, 2: ap-chuncheon-1, 3: ap-hyderabad-1, 4: ap-melbourne-1, 5: ap-mumbai-1, 6: ap-osaka-1, 7: ap-seoul-1, 8: ap-sydney-1, 9: ap-tokyo-1, 10: ca-montreal-1, 11: ca-toronto-1, 12: eu-amsterdam-1, 13: eu-frankfurt-1, 14: eu-zurich-1, 15: me-dubai-1, 16: me-jeddah-1, 17: sa-santiago-1, 18: sa-saopaulo-1, 19: uk-cardiff-1, 20: uk-gov-cardiff-1, 21: uk-gov-london-1, 22: uk-london-1, 23: us-ashburn-1, 24: us-gov-ashburn-1, 25: us-gov-chicago-1, 26: us-gov-phoenix-1, 27: us-langley-1, 28: us-luke-1, 29: us-phoenix-1, 30: us-sanjose-1): 9 #这里选择区域 Do you want to generate a new API Signing RSA key pair? (If you decline you will be asked to supply the path to an existing key.) [Y/n]: y #输入y Enter a directory for your keys to be created [/root/.oci]: Enter a name for your key [oci_api_key]: Public key written to: /root/.oci/oci_api_key_public.pem Enter a passphrase for your private key (empty for no passphrase): Private key written to: /root/.oci/oci_api_key.pem Fingerprint: Config written to /root/.oci/config ... 复制生成的公钥，获取命令如下：
cat /root/.oci/oci_api_key_public.pem 把展示出来的内容复制下来。并且添加到，甲骨文后台=>用户设置&raquo;资源&raquo;API秘钥&raquo;添加API秘钥
3、python脚本 安装python oci 假设你已经安装好python环境
pip install oci 登录证书 新建或使用系统已有的证书，本文直接查看本机已有证书记录下来 cat ~/.ssh/id_rsa.pub ssh-rsa AAAAB3NzaC1yc2EAAA......local 修改脚本 下载:
link 修改luanch.py 脚本中的参数 INSTANCE_NAME = 'vps实例名' #你要创建的vps实例名 SUBNET_ID = "网络->虚拟云网络->虚拟云网络详细信息->OCID" #如果是全新用户，先创建一个VNC compartment_id= &lt;font color=red>"租户id" ssh_public_key="id_rsa.pub的内容" 运行 执行脚本，当主机申请完成，会自动退出
python ./luanch.py</content></entry><entry><title>关于我</title><url>http://www.luckfu.com/about.html</url><categories/><tags/><content type="html"> 更多信息请访问GitHub.</content></entry></search>